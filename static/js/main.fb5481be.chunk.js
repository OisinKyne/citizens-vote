(this["webpackJsonpcitizens-vote"]=this["webpackJsonpcitizens-vote"]||[]).push([[0],{224:function(e){e.exports=JSON.parse('{"main":{"id":1,"address":"0xaa8a2ceb04f4ea6fbf9afc6bc542cc432cef88d3"},"rinkeby":{"id":4,"address":"0xc9f0ceebfa12ec7828245375cfb634bd387bbee7"},"private":{"id":99999,"address":"0x0000000000000000000000000000000000000000"}}')},369:function(e,t,a){e.exports=a.p+"static/media/ethereum-metamask-chrome.79226bac.png"},374:function(e){e.exports=JSON.parse('[{"constant":false,"inputs":[{"name":"billUri","type":"string"},{"name":"inFavour","type":"bool"}],"name":"vote","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"from","type":"address"},{"indexed":false,"name":"inFavour","type":"bool"},{"indexed":false,"name":"billUri","type":"string"}],"name":"Vote","type":"event"}]')},387:function(e,t,a){e.exports=a(884)},392:function(e,t,a){},433:function(e,t){},435:function(e,t){},477:function(e,t){},479:function(e,t){},545:function(e,t){},546:function(e,t){},551:function(e,t){},553:function(e,t){},560:function(e,t){},577:function(e,t){},620:function(e,t){},884:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(27),i=a.n(o),s=(a(392),a(29)),l=a.n(s),c=a(63),u=a(40),m=a(4),h=a(5),b=a(16),p=a(15),d=a(378),f=a(105),v=a(908),g=a(171),w=a.n(g),E=a(172),y=a.n(E),k=a(909),O=Object(f.a)({palette:{primary:{light:w.a[500],main:w.a[700],dark:w.a[900]},secondary:{light:y.a[300],main:y.a[500],dark:y.a[700]}},typography:{useNextVariants:!0}});var j=function(e){return function(t){return r.a.createElement(v.a,{theme:O},r.a.createElement(k.a,null),r.a.createElement(e,t))}},C=a(912),x=a(369),S=a.n(x),V=a(82);var N=Object(V.createLogger)({level:"info",format:V.format.combine(V.format.timestamp({format:"YYYY-MM-DD HH:mm:ss"}),V.format.splat(),V.format.json()),defaultMeta:{service:"citizens-vote-ui"},transports:[new V.transports.Console({format:V.format.json(),level:"warn"})]}),T=j(function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={open:!0},!0===e.web3Injected&&(N.info("Web3 is injected into this Onboarding object."),n.state={open:!1}),n}return Object(h.a)(a,[{key:"render",value:function(){return!1===this.state.open?null:r.a.createElement("div",{className:"onboardingDiv"},r.a.createElement(C.a,{container:!0,direction:"column",spacing:3,alignContent:"center",alignItems:"center"},r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement("a",{href:"https://metamask.io/",target:"_blank",rel:"noopener noreferrer",className:"metaMaskUrl"},r.a.createElement("img",{src:S.a,className:"fullWidthImage",alt:"MetaMask Fox Logo"}))),r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(d.a,{variant:"body1",gutterBottom:!0},"You need to install"," ",r.a.createElement("a",{href:"https://metamask.io/",target:"_blank",rel:"noopener noreferrer",className:"metaMaskUrl"},"MetaMask")," ","to post messages to the Ethereum blockchain."))))}}]),a}(r.a.Component)),B=a(890),F=a(913),I=a(914),M=function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"startCastVoteFor",value:function(e){this.props.triggerVoteCast(this.props.bill,!0)}},{key:"startCastVoteAgainst",value:function(e){this.props.triggerVoteCast(this.props.bill,!1)}},{key:"render",value:function(){var e="/";return this.props.bill.versions&&this.props.bill.versions.length>=1&&(e=this.props.bill.versions[0].version.formats.pdf.uri),r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(B.a,{className:"billPaper"},r.a.createElement(C.a,{container:!0,justify:"space-between",alignItems:"center"},r.a.createElement(C.a,{item:!0,xs:10},r.a.createElement(d.a,{variant:"h6",gutterBottom:!0},this.props.bill.shortTitleEn),r.a.createElement(d.a,{variant:"body1",gutterBottom:!0},this.props.bill.longTitleEn),r.a.createElement(C.a,{container:!0,justify:"space-between",alignItems:"flex-end",alignContent:"center",className:"billInfoGrid"},r.a.createElement(C.a,{item:!0},r.a.createElement(d.a,{variant:"body1"},r.a.createElement("b",null,"Read Bill:")," ",r.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"billPdfUrl"},"PDF"))),r.a.createElement(C.a,{item:!0},r.a.createElement(d.a,{variant:"body1"},r.a.createElement("b",null,"House:")," ",r.a.createElement("a",{href:this.props.bill.mostRecentStage.event.chamber?this.props.bill.mostRecentStage.event.chamber.uri:"#",target:"_blank",rel:"noopener noreferrer",className:"billPdfUrl"},this.props.bill.mostRecentStage.event.chamber?this.props.bill.mostRecentStage.event.chamber.showAs:""))),r.a.createElement(C.a,{item:!0},r.a.createElement(d.a,{variant:"body1"},r.a.createElement("b",null,"Stage:")," ",r.a.createElement("a",{href:this.props.bill.mostRecentStage.event.uri,target:"_blank",rel:"noopener noreferrer",className:"billPdfUrl"},this.props.bill.mostRecentStage.event.showAs?this.props.bill.mostRecentStage.event.showAs:"-"))))),r.a.createElement(C.a,{item:!0,xs:2},r.a.createElement(C.a,{container:!0,justify:"space-around",alignItems:"center"},r.a.createElement(C.a,{item:!0,onClick:this.startCastVoteFor.bind(this)},r.a.createElement(F.a,null),r.a.createElement(d.a,null,"T\xe1")),r.a.createElement(C.a,{item:!0,onClick:this.startCastVoteAgainst.bind(this)},r.a.createElement(I.a,null),r.a.createElement(d.a,null,"N\xedl")))))))}}]),a}(r.a.Component),A=function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).billItems=[],n.state={bills:[]},n.props.updateBills().then((function(e){e&&e.map&&(n.billItems=e.map((function(e,t){return r.a.createElement(M,{bill:e,key:t,triggerVoteCast:n.props.triggerVoteCast})})),n.setState(Object(u.a)(Object(u.a)({},n.state),{},{bills:e})))})),n}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.a,{variant:"h4",gutterBottom:!0},this.billItems.length," D\xe1il Bills"),r.a.createElement("div",null,r.a.createElement(C.a,{container:!0,direction:"column",spacing:3},this.billItems)))}}]),a}(r.a.Component),U=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,[{key:"getDailBills",value:function(){var e=Object(c.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){a(507)(t).then((function(t){e(JSON.parse(t))})).catch((function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"prepareDailBillsRequestUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Current",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2019-05-01",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2019-06-08",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"50",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en";return"https://api.oireachtas.ie/v1/legislation?bill_status=".concat(e,"&bill_source=Government,Private%20Member&date_start=").concat(t,"&date_end=").concat(a,"&limit=").concat(n,"&chamber_id=").concat(r,"&lang=").concat(o)}}]),e}(),P=a(162),R=a(922),D=a(915),W=a(916),_=a(923),H=a(917),Y=a(918),z=a(919),G=a(920),J=a(921),q=a(223),L=a.n(q),K=a(374),$=a(224),Q=function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={web3:n.getWeb3().catch((function(){N.warn("Failed to get a web3 object while instantiating Blockchain Service")}))},n}return Object(h.a)(a,[{key:"getWeb3",value:function(){var e=Object(c.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(l.a.mark((function e(t,a){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=15;break}return window.web3=new L.a(window.ethereum),e.prev=2,e.next=5,window.ethereum.enable();case 5:(n=e.sent).length>=1&&(window.web3.eth.defaultAccount=n[0]),t(window.web3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),N.error("Calling window.ethereum.enable() threw an error. Something is probably wrong. ");case 13:e.next=16;break;case 15:window.web3?(N.info("Window.web3 provided"),window.web3=new L.a(window.web3.currentProvider),t(window.web3)):(N.warn("No web3 provider detected"),a("No web3 provider detected"));case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getVoteContractAddress",value:function(e){if("rinkeby"===e)return $.rinkeby.address;if("main"===e)return $.main.address;throw new Error("Unknown ethereum network name")}},{key:"castVote",value:function(){var e=Object(c.a)(l.a.mark((function e(t,a){var n,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.web3;case 2:return n=e.sent,e.next=5,n.eth.net.getNetworkType();case 5:if(r=e.sent,o=this.getVoteContractAddress(r),n.eth.defaultAccount){e.next=9;break}throw new Error("No web3.eth.defaultAccount available. Something went wrong. ");case 9:return e.abrupt("return",new Promise((function(e,r){n?new n.eth.Contract(K,o,{defaultGasPrice:1.1*n.eth.gasPrice}).methods.vote(t,a).send({from:n.eth.defaultAccount}).then((function(t){e(t)})).catch((function(e){r(e)})):r("No web3 object could be read from state")})));case 10:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}],[{key:"isWeb3Injected",value:function(){return window.ethereum?(N.info("Window.ethereum provided."),!0):window.web3?(N.info("Window.web3 provided"),!0):(N.warn("No web3 provider detected"),!1)}}]),a}(r.a.Component),X={act:"",amendmentLists:[],billNo:"",billType:"",billTypeURI:"",billYear:"",debates:[],events:[],lastUpdated:"",longTitleEn:"",longTitleGa:"",method:"",methodURI:"",mostRecentStage:{event:{chamber:{chamberCode:"",showAs:"",uri:""},dates:[],house:{chamberCode:"",chamberType:"",houseCode:"",houseNo:"",showAs:"",uri:""},progressStage:0,showAs:"",stageCompleted:!1,stageOutcome:null,stageURI:"",uri:""}},originHouse:{showAs:"",uri:""},relatedDocs:[],shortTitleEn:"",shortTitleGa:"",source:"",sourceURI:"",sponsors:[],stages:[],status:"",statusURI:"",uri:"",versions:[]},Z=function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={inFavour:n.props.inFavour,name:"",email:""},n}return Object(h.a)(a,[{key:"setTaNilTab",value:function(){this.setState(Object(u.a)(Object(u.a)({},this.state),{},{inFavour:this.props.inFavour}))}},{key:"castVote",value:function(){var e=Object(c.a)(l.a.mark((function e(t,a,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){N.info("Casting Vote. BillTitle: ".concat(t.shortTitleEn,", inFavour: ").concat(a));var i=n("Casting your vote",{variant:"info"});new Q(null).castVote(t.uri,a).then((function(){N.info("BlockchainServcice.CastVote() resolved, closing Vote Cast Snackbar"),r(i),e()})).catch((function(){var e=n("Failed to cast vote",{variant:"error"});setTimeout((function(){r(e)}),3e3),N.warn("BlockchainService.voteCast triggered a catch block, user likely rejected transaction"),o("BlockchainService.voteCast triggered a catch block")}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.props.bill?r.a.createElement(R.a,{open:this.props.open,onEnter:this.setTaNilTab.bind(this),onClose:this.props.handleClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(D.a,{id:"form-dialog-title"},this.props.bill.shortTitleEn),r.a.createElement(W.a,null,r.a.createElement(B.a,{square:!0,className:"voteModalTabPaperComponent"},r.a.createElement(_.a,{value:this.state.inFavour?0:1,onChange:function(t,a){1===a?e.setState(Object(u.a)(Object(u.a)({},e.state),{},{inFavour:!1})):e.setState(Object(u.a)(Object(u.a)({},e.state),{},{inFavour:!0}))},variant:"fullWidth",indicatorColor:"primary",textColor:"primary"},r.a.createElement(H.a,{icon:r.a.createElement(F.a,null),label:"T\xe1"}),r.a.createElement(H.a,{icon:r.a.createElement(I.a,null),label:"N\xedl"}))),r.a.createElement(Y.a,null,"You are going to cast your vote"," ",r.a.createElement("b",null,this.state.inFavour?"for":"against")," this measure."),r.a.createElement(Y.a,null,this.props.bill.longTitleEn)),r.a.createElement(z.a,null,r.a.createElement(G.a,{id:"CancelVoteButton",onClick:this.props.handleClose,color:"primary",variant:"contained"},"Cancel"),r.a.createElement(G.a,{id:"CastVoteButton",variant:"contained",onClick:function(){var t=e.props.bill?e.props.bill:X;e.castVote(t,e.props.inFavour,e.props.enqueueSnackbar,e.props.closeSnackbar).then((function(){N.info("Cast vote button on click returned")})).catch((function(){N.warn("Casting a vote failed")})),e.props.handleClose()},color:"primary"},"Cast Vote",r.a.createElement(J.a,null)))):(N.info("Not rendering without a bill object passed as a prop to CastVoteModal. "),r.a.createElement("div",null))}}]),a}(r.a.Component),ee=Object(P.withSnackbar)(Z),te=j(function(e){Object(b.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).handleClose=function(e,t){n.setState(Object(u.a)(Object(u.a)({},n.state),{},{castVoteModalOpen:!1}))},n.isWeb3User=function(){return Q.isWeb3Injected()},n.handleClick=function(){n.setState(Object(u.a)(Object(u.a)({},n.state),{},{castVoteModalOpen:!0}))},n.state={castVoteModalOpen:!1,bills:[],billToVoteOn:void 0,inFavour:!1},n}return Object(h.a)(a,[{key:"updateBills",value:function(){var e=Object(c.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var a=new U,n=new Date,r=new Date(n.getTime()-6048e5).toISOString().substring(0,10),o=new Date(n.getTime()+12096e5).toISOString().substring(0,10),i=a.prepareDailBillsRequestUrl("Current",r,o,"50","","ga");e(a.getDailBills(i).then((function(e){return e.results?(N.info("".concat(e.results.length," results returned from api.oireachtas.ie")),e.results.map((function(e){return e.bill}))):void N.warn("api.oireachtas.ie returned no results for voting on.")})).catch((function(e){N.error("Error thrown while trying to retrieve bills from the oireachtas api. "),t(e)})))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"triggerCastVoteModal",value:function(e,t){this.setState(Object(u.a)(Object(u.a)({},this.state),{},{castVoteModalOpen:!0,billToVoteOn:e,inFavour:t}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"centerColumn"},r.a.createElement(ee,{open:this.state.castVoteModalOpen,handleClose:this.handleClose,bill:this.state.billToVoteOn,inFavour:this.state.inFavour}),r.a.createElement(C.a,{container:!0,spacing:2},r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(B.a,{className:"paper"},r.a.createElement(d.a,{variant:"h3",gutterBottom:!0},"Have your say on Bills in the Oireachtas"),r.a.createElement(d.a,{variant:"body1",gutterBottom:!0},"Through the use of the"," ",r.a.createElement("a",{href:"https://api.oireachtas.ie/",target:"_blank",rel:"noopener noreferrer"},"Oireachtas Open Data API"),"; this website allows you to vote on current D\xe1il & Seanad legislation, and record that vote permanently to the Ethereum Blockchain."),r.a.createElement(d.a,{variant:"body1",gutterBottom:!0},"Citizens vote allows for any citizen to build up a voting record that they ",r.a.createElement("em",null,"cannot")," change. This allows first time candidates for elected office to be compared against incumbent candidates ",r.a.createElement("i",null,"vote for vote"),". How do the two measure up on climate change bills? How do the incumbent and challenger compare on tax bills? Abortion rights? Any contentious bill a voter wants to look at, if the challenger has been commiting their votes to the blockchain, a voter can trust that the candidate could not have changed that vote since the time it was cast. They can now fairly compare how the challenger voted and how the incumbent voted in the D\xe1il. Rather than relying on what candidates say they are going to do during the election cycle."))),this.isWeb3User()?r.a.createElement("div",null):r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(B.a,{className:"paper"},r.a.createElement(T,{web3Injected:this.isWeb3User()}))),r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(B.a,{className:"paper"},r.a.createElement(A,{updateBills:this.updateBills,triggerVoteCast:this.triggerCastVoteModal.bind(this)}))),r.a.createElement(C.a,{item:!0,xs:12},r.a.createElement(B.a,{className:"paper"},r.a.createElement(d.a,{variant:"caption"},"Built by Ois\xedn Kyne. To donate some Ether:"," ",r.a.createElement("a",{href:"https://etherscan.io/address/0xa338096d43efFc151E7e89519b524CA5a7E5626f",target:"_blank",rel:"noopener noreferrer"},"oisinkyne.eth"))))))}}]),a}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(P.SnackbarProvider,{maxSnack:1},r.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[387,1,2]]]);
//# sourceMappingURL=main.fb5481be.chunk.js.map